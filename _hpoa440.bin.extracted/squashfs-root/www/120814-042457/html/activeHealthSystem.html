<!--  (C) Copyright 2011 Hewlett-Packard Development Company, L.P.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>HP BladeSystem Onboard Administrator</title>
<link rel="stylesheet" type="text/css" href="../css/default.css"/>
<link rel="stylesheet" type="text/css" href="../css/blue_theme.css"/>
<link rel="stylesheet" type="text/css" href="../css/MxPortalEx.css"/>
<script type="text/javascript" src="../js/EnvironConstants.js"></script>
<script type="text/javascript" src="../js/tableManager.js"></script>
<script type="text/javascript" src="../js/buttonManager.js"></script>
<script type="text/javascript" src="../js/global.js"></script>
<script type="text/javascript" src="../js/formManager.js"></script>
<script type="text/javascript" src="../js/displayManager.js"></script>
<script type="text/javascript" src="../js/batchManager.js"></script>
<script type="text/javascript" src="../js/browser.js"></script>
<script type="text/javascript" src="../js/init.js"></script>
<script type="text/javascript" src="../js/xml.js"></script>
<script type="text/javascript" src="../js/xslt.js"></script>
<script type="text/javascript" src="../js/snmp.js"></script>
<script type="text/javascript" src="../js/inputValidator.js"></script>
<script type="text/javascript">	
var encNum;
var hpem=null;
function loadContent(){
try{
encNum=parseInt(getSearchValue(location.search,'encNum'));
if(!isNaN(encNum)&&(hpem=top.mainPage.getHiddenFrame().getProxy(encNum))!=null){
setBodyContent(true,true);
hpem.registerEventHandler(handleActiveHealthSystemEvent,['EVENT_NETWORK_INFO_CHANGED']);
}else{
displayContentFailed('bodyContent',[top.getString('noOnboardAdmin')]);
}
}catch(e){
displayContentFailed('bodyContent',[e.message]);
}
}
function setBodyContent(init,fresh){
top.mainPage.getHelpLauncher().setCurrentTopic('FORM_ACTIVE_HEALTH_SYSTEM');
var formMgr=new FormManager(function(success){
var processor=new XsltProcessor('../Forms/ActiveHealthSystem.xsl');
processor.addParameter('stringsDoc',top.getStringsDoc());
processor.addParameter('encNetworkInfoDoc',formMgr.getDataByCallIndex(0));
processor.addParameter('serviceUserAcl',hpem.getUserAccessLevel());
document.getElementById('bodyContent').innerHTML=processor.getOutput();
reconcilePage();
},false,null,'bodyContent',null);
if(init){
formMgr.startBatch(true,assertFalse(fresh));
}else{
formMgr.startTransactionBatch(assertFalse(fresh));
}
formMgr.queueCall(hpem.getEnclosureNetworkInfo);
formMgr.endBatch();
}
function setActiveHealthSystem(){
var enableActiveHealthSystem=getInputValue("chkActiveHealthSystem");
var formMgr=new FormManager(function(success){
},false,'','bodyContent','waitContainer');
formMgr.createWaitContainer(top.getString('configuringActiveHealthSystem'));
formMgr.startBatch();
formMgr.queueCall(hpem.setNetworkProtocol,[NET_PROTO_ACTIVE_HEALTH_SYSTEM(),enableActiveHealthSystem],[],['83','84']);
formMgr.endBatch();
}
function handleActiveHealthSystemEvent(result){
var eventName=getElementValueXpath(result,"//hpoa:event");
switch(eventName){
case "EVENT_NETWORK_INFO_CHANGED":
setBodyContent(false,true);
break;
default:
break;
}
}
function refreshPage(){
setBodyContent(true,true);
}
function pageUnload(){
try{
hpem.removeRegisteredHandler(handleActiveHealthSystemEvent);
}catch(e){}
}
</script>
</head>
<body style="margin:10px;" onload="loadContent();" onunload="pageUnload();">
  <div id="bodyContent"></div>
  <div id="waitContainer" class="waitContainer"></div>
</body>
</html>
