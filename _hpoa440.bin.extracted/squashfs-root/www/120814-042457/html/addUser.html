<!--  (C) Copyright 2006-2014 Hewlett-Packard Development Company, L.P.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>HP BladeSystem Onboard Administrator</title>
<link rel="stylesheet" type="text/css" href="../css/default.css"/>
<link rel="stylesheet" type="text/css" href="../css/blue_theme.css"/>
<link rel="stylesheet" type="text/css" href="../css/MxPortalEx.css"/>
<script type="text/javascript" src="../js/EnvironConstants.js"></script>
<script type="text/javascript" src="../js/inputValidator.js"></script>
<script type="text/javascript" src="../js/buttonManager.js"></script>
<script type="text/javascript" src="../js/tableManager.js"></script>
<script type="text/javascript" src="../js/users.js"></script>
<script type="text/javascript" src="../js/formManager.js"></script>
<script type="text/javascript" src="../js/displayManager.js"></script>
<script type="text/javascript" src="../js/global.js"></script>
<script type="text/javascript" src="../js/browser.js"></script>
<script type="text/javascript" src="../js/init.js"></script>
<script type="text/javascript" src="../js/xml.js"></script>
<script type="text/javascript" src="../js/xslt.js"></script>

<script type="text/javascript">
var encNum;
var hpem=null;
var ourInputValidator=null;
var user='';
function addUser(){
ourInputValidator.clearMessages();
if(ourInputValidator.allInputsValidate()){
var username=document.getElementById('username').value;
var password=document.getElementById('password').value;
user=username;
var formMgr=new FormManager(function(success){
if(success){
document.getElementById('errorDisplay').style.display='block';
document.getElementById('bodyContent').style.display='none';
}
},false,'errorDisplay','bodyContent','waitContainer');
formMgr.createWaitContainer(top.getString('addingUser'));
formMgr.startBatch();
formMgr.queueCall(hpem.addUser,[username,password],['lblUsername','lblPassword','lblPasswordConfirm']);
formMgr.endBatch();
}
else{
ourInputValidator.updateMessages(true);
ourInputValidator.autoFocus();
}
}
function pageLoad(){
top.mainPage.setMainTitle(top.getString('addLocalUser'));
top.mainPage.getHelpLauncher().setCurrentTopic("FORM_USER_ADD");
encNum=parseInt(getSearchValue(location.search,'encNum'));
hpem=top.mainPage.getHiddenFrame().getProxy(encNum);
var formMgr=new FormManager(function(success){
hpem.registerEventHandler(userAdded,['EVENT_USER_ADDED']);
var processor=new XsltProcessor('../Forms/addUser.xsl');
processor.addParameter('stringsDoc',top.getStringsDoc());
processor.addParameter('passwordSettingsDoc',hpem.getPasswordSettings());
document.getElementById('bodyContent').innerHTML=processor.getOutput();
reconcilePage();
focusTextbox("username");
ourInputValidator=new InputValidator(null,"errorDisplay",true);
});
formMgr.startBatch(true);
formMgr.queueCall(hpem.getPasswordSettings);
formMgr.endBatch();
}
function userAdded(result){
var username=getElementValueXpath(result,'//hpoa:userInfo/hpoa:username');
if(username==user){
location='/120814-042457/html/editUser.html?encNum='+encNum+'&action=edit&username='+username;
}
}
  </script>
</head>
<body style="margin:10px;" onload="pageLoad();">
  <div id="bodyContent"></div>
  <div id="waitContainer" class="waitContainer"></div>  
</body>
</html>

