<!--  (C) Copyright 2006-2014 Hewlett-Packard Development Company, L.P.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>HP BladeSystem Onboard Administrator</title>
<link rel="stylesheet" type="text/css" href="../css/default.css" />
<link rel="stylesheet" type="text/css" href="../css/blue_theme.css" />
<link rel="stylesheet" type="text/css" href="../css/widgets.css" />
<link href="../css/MxPortalEx.css" rel="stylesheet" type="text/css" />
<script src="../js/EnvironConstants.js" type="text/javascript"></script>
<script type="text/javascript" src="../js/tabManager.js"></script>
<script type="text/javascript" src="../js/buttonManager.js"></script>
<script type="text/javascript" src="../js/inputValidator.js"></script>
<script type="text/javascript" src="../js/displayManager.js"></script>
<script type="text/javascript" src="../js/formManager.js"></script>
<script type="text/javascript" src="../js/global.js"></script>
<script type="text/javascript" src="../js/browser.js"></script>
<script type="text/javascript" src="../js/init.js"></script>
<script type="text/javascript" src="../js/xml.js"></script>
<script type="text/javascript" src="../js/xslt.js"></script>

<script type="text/javascript">  
var hpem=null;
function myOnload(){
top.mainPage.setMainTitle(top.getString('userPreferences'));
top.mainPage.getHelpLauncher().setCurrentTopic("FORM_USER_PREFS");
hpem=top.getTopology().getProxyLocal();
hpem.registerEventHandler(languageChangedHandler,['EVENT_LANG_PACK_ADDED','EVENT_LANG_PACK_REMOVED']);
loadContent();
}
function loadContent(){
var formMgr=new FormManager(function(success){
var preferredLanguage='';
var timeoutPref='';
var processor=new XsltProcessor('../Templates/userPrefs.xsl');
processor.addParameter('stringsDoc',top.getStringsDoc());
if(document.cookie!=null){
preferredLanguage=getCookieValue(LANGUAGE_COOKIE_NAME());
timeoutPref=getCookieValue(GUI_TIMEOUT_COOKIE_NAME());
}
processor.addParameter('availableLanguagesDoc',hpem.getLanguages());
processor.addParameter('serviceUserAcl',hpem.getUserAccessLevel());
processor.addParameter('serviceUserOaAccess',hpem.getUserOaPermission());
processor.addParameter('preferredLanguage',preferredLanguage);
processor.addParameter('timeoutPref',timeoutPref);
var bodyContent=document.getElementById('bodyContent');
bodyContent.innerHTML=processor.getOutput();
reconcilePage();
});
formMgr.startBatch(true);
formMgr.queueCall(hpem.getLanguages);
formMgr.endBatch();
}
function languageChangedHandler(result){
var event=getElementValueXpath(result,"//hpoa:event");
switch(event){
case 'EVENT_LANG_PACK_ADDED':
top.mainPage.showNotice(top.getString("languagePackAdded"),top.getString("userPreferences"),AlertMsgTypes.Normal,null,10);
loadContent();
break;
case 'EVENT_LANG_PACK_REMOVED':
top.mainPage.showNotice(top.getString("languagePackRemoved"),top.getString("userPreferences"),AlertMsgTypes.Normal,null,10);
loadContent();
break;
default:
}
}
function setLanguagePreference(){
var langSelect=document.getElementById('languages');
var langPref=langSelect.options[langSelect.selectedIndex].value;
if(langPref!='-'){
var expires=new Date();
expires.setMonth(new Date().getYear()+100);
setCookieValue(LANGUAGE_COOKIE_NAME(),langPref,expires);
}
else{
deleteCookieValue(LANGUAGE_COOKIE_NAME());
}
if(langPref!=top.getStringManager().getProperty("AcceptLanguage")){
top.refreshStrings();
}else{
top.mainPage.displayNotice(top.getString("languagePrefSaved")+"\n\n\n",null,AlertMsgTypes.Normal,null,5);
}
}
function setSessionTimeoutPreference(){
if(cookiesEnabled()==false){
alert(top.getString('cookiesMustBeEnabled'),AlertMsgTypes.Warning,60);
return;
}
var timeoutMenu=document.getElementById('timeout_pref');
var timeoutPref='';
if(timeoutMenu){
timeoutPref=timeoutMenu.options[timeoutMenu.selectedIndex].value;
var expires=new Date();
expires.setMonth(new Date().getYear()+100);
setCookieValue(GUI_TIMEOUT_COOKIE_NAME(),timeoutPref,expires);
top.mainPage.displayNotice(top.getString('sessionTimeoutPrefSaved')+"\n\n\n",null,AlertMsgTypes.Normal,null,5);
}
};
function selectLanguageUpdatePage(){
var encNum=hpem.getEnclosureNumber();
var emNum=hpem.getOaBayNumber(ACTIVE());
top.mainPage.getHiddenFrame().selectDevice(emNum,"em",encNum,true,true);
top.mainPage.getNavigationFrame().highlightDevice("enc"+encNum+"FirmwareUpdateSelect");
window.location="/120814-042457/html/oaFirmwareUpdate.html?emNum="+emNum+"&encNum="+encNum+"&tabId=languageUpdate";
};
function myUnload(){
try{
hpem.removeRegisteredHandler(languageChangedHandler);
}catch(e){}
}
  </script>
</head>
<body style="margin:10px;" onload="myOnload();" onunload="myUnload();">
  <div id="bodyContent"></div>
  <div id="waitContainer" class="waitContainer"></div>
</body>
</html>
