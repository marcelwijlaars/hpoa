<!--	(C) Copyright 2006-2014 Hewlett-Packard Development Company, L.P.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>HP BladeSystem Onboard Administrator</title>
<link rel="stylesheet" type="text/css" href="../css/default.css">
<link rel="stylesheet" type="text/css" href="../css/blue_theme.css">
<link rel="stylesheet" type="text/css" href="../css/MxPortalEx.css">
<link href="../css/widgets.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="../js/EnvironConstants.js"></script>
<script type="text/javascript" src="../js/formManager.js"></script>
<script type="text/javascript" src="../js/displayManager.js"></script>
<script type="text/javascript" src="../js/buttonManager.js"></script>
<script type="text/javascript" src="../js/global.js"></script>
<script type="text/javascript" src="../js/browser.js"></script>

 <!--
	Include the init and xml javascript files from the jsolait library.
	The xslt.js file requires that these two files be included before it.
-->
<script type="text/javascript" src="../js/init.js"></script>
<script type="text/javascript" src="../js/xml.js"></script>
<script type="text/javascript" src="../js/xslt.js"></script>

<script type="text/javascript">
var encNum='';
var hpem=null;
var fwVersion="1.30";
var encType=0;
function loadContent(){
try{
encNum=parseInt(getSearchValue(location.search,'encNum'));
if(!isNaN(encNum)&&(hpem=top.mainPage.getHiddenFrame().getProxy(encNum))!=null){
var oaInfo=hpem.getOaInfo(hpem.getOaBayNumber("ACTIVE"));
if(oaInfo){
fwVersion=getElementValueXpath(oaInfo,'//hpoa:fwVersion');
}
if(fwVersion>="2.00"){
encType=hpem.getEnclosureType();
}
loadPtInfo(false);
hpem.registerEventHandler(handlePtEvent,['EVENT_POWER_INFO','EVENT_PS_SUBSYSTEM_STATUS','EVENT_ENC_GRP_CAP']);
try{
top.mainPage.getHelpLauncher().setCurrentTopic("FORM_POWER_THERMAL_OVERVIEW");
}catch(e){
displayContentFailed('bodyContent',[e.message]);
}
}else{
displayContentFailed('bodyContent',[top.getString('noOnboardAdmin')]);
}
}catch(e){
displayContentFailed('bodyContent',[e.message]);
}
}
function loadPtInfo(fresh){
var formMgr=new FormManager(function(success){
if(success){
var processor=new XsltProcessor('../Templates/powerThermal.xsl');
processor.addParameter('stringsDoc',top.getStringsDoc());
processor.addParameter('powerSubsystemInfoDoc',hpem.getPowerSubsystemInfo());
processor.addParameter('powerConfigInfoDoc',hpem.getPowerConfigInfo());
processor.addParameter('thermalSubsystemInfoDoc',hpem.getThermalSubsystemInfo());
processor.addParameter('enclosureThermalsDoc',hpem.getEnclosureThermalInfo());
processor.addParameter('powerCapConfigDoc',hpem.getPowerCapConfig());
if(fwVersion>="2.00"){
processor.addParameter('enclosureType',encType);
}
document.getElementById('bodyContent').innerHTML=processor.getOutput();
reconcilePage();
}else{
displayContentFailed('bodyContent',[formMgr.getErrorsArray()]);
}
},false,'','bodyContent','waitContainer');
formMgr.startBatch(true,fresh);
formMgr.queueCall(hpem.getPowerSubsystemInfo);
formMgr.queueCall(hpem.getPowerConfigInfo);
formMgr.queueCall(hpem.getThermalSubsystemInfo);
formMgr.queueCall(hpem.getEnclosureThermalInfo);
formMgr.queueCall(hpem.getPowerCapConfig);
formMgr.endBatch();
}
function handlePtEvent(result){
loadPtInfo(false);
}
function refreshPtInfo(){
loadPtInfo(true);
}
</script>
</head>
<body style="margin:10px;" onload="loadContent();">
    <div id="bodyContent"></div>
    <div id="waitContainer"></div>
</body>
</html>
