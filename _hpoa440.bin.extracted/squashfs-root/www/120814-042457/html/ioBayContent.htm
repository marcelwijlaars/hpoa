<!--	(C) Copyright 2006-2014 Hewlett-Packard Development Company, L.P.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title></title>
<link rel="stylesheet" type="text/css" href="../css/default.css"/>
<link rel="stylesheet" type="text/css" href="../css/blue_theme.css"/>
<link rel="stylesheet" type="text/css" href="../css/MxPortalEx.css"/>
<link rel="stylesheet" type="text/css" href="../Help/stylesheets/help.css"/>
<script type="text/javascript" src="../js/EnvironConstants.js"></script>
<script type="text/javascript" src="../js/tabManager.js"></script>
<script type="text/javascript" src="../js/buttonManager.js"></script>
<script type="text/javascript" src="../js/formManager.js"></script>
<script type="text/javascript" src="../js/displayManager.js"></script>
<script type="text/javascript" src="../js/global.js"></script>
<script type="text/javascript" src="../js/browser.js"></script>
<script type="text/javascript" src="../js/init.js"></script>
<script type="text/javascript" src="../js/xml.js"></script>
<script type="text/javascript" src="../js/xslt.js"></script>
<script type="text/javascript" src="../js/helpTips.js"></script>

<script type="text/javascript">
var bayNum;
var encNum;
var hpem=null;
function selectTab(tabId){
try{
bayNum=parseInt(getSearchValue(location.search,'bayNum'));
encNum=parseInt(getSearchValue(location.search,'encNum'));
if(!isNaN(bayNum)&&!isNaN(encNum)&&(hpem=top.mainPage.getHiddenFrame().getProxy(encNum))!=null){
var interconnectEvents=[
'EVENT_INTERCONNECT_STATUS',
'EVENT_INTERCONNECT_INFO',
'EVENT_INTERCONNECT_UID',
'EVENT_INTERCONNECT_RESET',
'EVENT_SWITCH_CONNECT',
'EVENT_SWITCH_DISCONNECT',
'EVENT_INTERCONNECT_HEALTH_LED',
'EVENT_INTERCONNECT_THERMAL',
'EVENT_INTERCONNECT_CPUFAULT',
'EVENT_INTERCONNECT_POWER'
];
hpem.registerEventHandler(netTrayChanged,interconnectEvents);
hpem.registerEventHandler(netTrayRemoved,['EVENT_INTERCONNECT_REMOVED']);
hpem.registerEventHandler(netTrayInserted,['EVENT_INTERCONNECT_INSERTED']);
ourTabManager.toggleTabs(tabId);
setTabContent(tabId);
}
}
catch(e){}
}
function getCurrentTab(){
return ourTabManager.getCurrentTab();
}
function setTabContent(tabId){
var contentTab=document.getElementById(tabId);
var contentLocation=contentTab.getAttribute('contentLocation');
var contextHelpId=contentTab.getAttribute('contextId');
if(contentLocation){
try{
if(hpem!=null){
var formMgr=new FormManager(function(success){
var processor=new XsltProcessor(contentLocation);
processor.addParameter('stringsDoc',top.getStringsDoc());
processor.addParameter('netTrayInfoDoc',hpem.getInterconnectTrayInfo(bayNum));
processor.addParameter('netTrayStatusDoc',hpem.getInterconnectTrayStatus(bayNum));
processor.addParameter('serviceUserAcl',hpem.getUserAccessLevel());
processor.addParameter('vlanInfoDoc',hpem.getVlanInfo());
processor.addParameter('enclosureNumber',encNum);
processor.addParameter('isLocal',''+hpem.getIsLocal());
var proxyUrl=hpem.getProxyUrl();
if(proxyUrl.lastIndexOf('/')==proxyUrl.length-1){
proxyUrl=proxyUrl.substring(0,proxyUrl.length-1);
}
processor.addParameter('proxyUrl',proxyUrl);
document.getElementById('tabContent').innerHTML=processor.getOutput();
reconcilePage();
},true,'','tabContent');
formMgr.startBatch(true);
formMgr.queueCall(hpem.getInterconnectTrayInfo,[bayNum]);
formMgr.queueCall(hpem.getInterconnectTrayStatus,[bayNum]);
formMgr.queueCall(hpem.getVlanInfo);
formMgr.endBatch();
top.mainPage.getHelpLauncher().setCurrentTopic(contextHelpId);
}else{
displayContentFailed('tabContent',[top.getString('noOnboardAdmin')]);
}
}catch(e){
displayContentFailed('tabContent',[e.message]);
}
}
}
function netTrayVlanInfoChanged(result){
}
function netTrayChanged(result){
var bayNumber=getElementValueXpath(result,'//hpoa:bayNumber');
if(bayNumber==bayNum){
selectTab(getCurrentTab());
}
}
function netTrayRemoved(result){
var bayNumber=getElementValueXpath(result,'//hpoa:interconnectTrayStatus/hpoa:bayNumber');
if(bayNumber==bayNum){
document.getElementById('bodyContent').innerHTML=top.getString('interconnectWasRemoved');
}
}
function netTrayInserted(result){
var bayNumber=getElementValueXpath(result,'//hpoa:bayNumber');
if(bayNumber==bayNum){
location.reload();
}
}
function setNetTrayPower(state){
var confirmString=top.getString('ioPowerConfirm');
if(confirm(confirmString)){
hpem.setInterconnectTrayPower(bayNum,state,function(result){
});
}
}
function resetNetTray(){
var powerMsg='';
var confirmString=top.getString('ioPowerConfirm');
if(confirm(confirmString)){
hpem.resetInterconnectTray(bayNum,function(result){
if(result.xml!=''&&result.xml.indexOf(SOAP_FAULT_TEST())==-1){
powerMsg=top.getString('interconnectReceivedResetCommand');
}
else{
powerMsg=top.getString('problemResettingInterconnect');
}
document.getElementById('powerMsg').innerHTML=powerMsg;
});
}
}
function setUidState(state){
hpem.setInterconnectTrayUid(bayNum,state,function(result){});
}
function deRegisterEventHandlers(){
hpem.removeRegisteredHandler(netTrayChanged);
hpem.removeRegisteredHandler(netTrayRemoved);
hpem.removeRegisteredHandler(netTrayInserted);
}
	</script>
</head>
<body style="margin:10px;" onload="selectTab('bayStatus');" onunload="deRegisterEventHandlers();">
	<div id="bodyContent">
	
		<table cellpadding="0" cellspacing="0" border="0" width="100%">
			<tr>
				<td valign="bottom">
					<div class="tabSet" id="tabSet">
						<!-- TODO: Update context id's for help system. -->
						<div class="tabOff" tabid="bayStatus" contextId="FORM_SWM_STATUS" id="bayStatus" contentLocation="../Templates/ioStatus.xsl"><script type="text/javascript">document.write(top.getString('status'));</script></div>
						<div class="tabOff" tabid="bayInfo" contextId="FORM_SWM_INFO" id="bayInfo" contentLocation="../Templates/ioInfo.xsl"><script type="text/javascript">document.write(top.getString('information'));</script></div>
						<div class="tabOff" tabid="bayVirtualButtons" contextId="FORM_SWM_VIRTUAL_BUTTONS" id="bayVirtualButtons" contentLocation="../Templates/ioVirtualButtons.xsl"><script type="text/javascript">document.write(top.getString('virtualButtons'));</script></div>
						<div class="tabBottomLine"></div>
					</div>
				</td>
			</tr>
			<tr>
				<td style="padding-top:10px;">
					<div id="tabContent"></div>
				</td>
			</tr>
		</table>

    <script type="text/javascript">
if(typeof(TabManager)!="undefined"){
ourTabManager.init();
}
    </script>
		
	</div>
	
  <div id="helpTooltip" class="popupSmallWrapper">
		<div class="popupSmallTitle"><img alt="" src="/120814-042457/images/icons/help-popup.gif" /></div>
		<div id="tooltipText" class="helpPopupSmallBody"></div>
  </div>
  <div id="tooltip" class="popupSmallWrapper" onclick="killToolTip();" onmouseover="clearTooltipTimer();" onmouseout="updateTooltipTimer();" style="top:0;left:0;">
	<div class="popupSmallBody" style="background-color:#fff;"></div>
  </div>
</body>
</html>
