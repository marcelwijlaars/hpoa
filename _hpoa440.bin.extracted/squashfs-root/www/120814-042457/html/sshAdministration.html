<!--	(C) Copyright 2006-2014 Hewlett-Packard Development Company, L.P.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>HP BladeSystem Onboard Administrator</title>
<link rel="stylesheet" type="text/css" href="../css/default.css">
<link rel="stylesheet" type="text/css" href="../css/blue_theme.css">
<link rel="stylesheet" type="text/css" href="../css/MxPortalEx.css">
<script type="text/javascript" src="../js/buttonManager.js"></script>
<script type="text/javascript" src="../js/EnvironConstants.js"></script>
<script type="text/javascript" src="../js/formManager.js"></script>
<script type="text/javascript" src="../js/displayManager.js"></script>
<script type="text/javascript" src="../js/tableManager.js"></script>
<script type="text/javascript" src="../js/global.js"></script>
<script type="text/javascript" src="../js/browser.js"></script>

 <!--
	Include the init and xml javascript files from the jsolait library.
	The xslt.js file requires that these two files be included before it.
-->
<script type="text/javascript" src="../js/init.js"></script>
<script type="text/javascript" src="../js/xml.js"></script>
<script type="text/javascript" src="../js/xslt.js"></script>

<script type="text/javascript">
var encNum;
function loadContent(){
try{
encNum=parseInt(getSearchValue(location.search,'encNum'));
if(!isNaN(encNum)&&(hpem=top.mainPage.getHiddenFrame().getProxy(encNum))!=null){
transformPage();
}
else{
displayContentFailed('bodyContent',[top.getString('noOnboardAdmin')]);
}
}
catch(e){
displayContentFailed('bodyContent',[e.message]);
}
top.mainPage.setMainTitle(top.getString('SSHAdmin'));
}
function transformPage(){
var formMgr=new FormManager(function(success){
if(success){
var processor=new XsltProcessor('../Templates/sshAdministration.xsl');
processor.addParameter('stringsDoc',top.getStringsDoc());
processor.addParameter('sshKeysDoc',formMgr.getDataByCallIndex(0));
processor.addParameter('sshFingerprint',formMgr.getDataByCallName('getSshFingerprint',[],'//hpoa:sshFingerprint'));
document.getElementById('bodyContent').innerHTML=processor.getOutput();
top.mainPage.getHelpLauncher().setCurrentTopic("FORM_SSH_ADMINISTRATION");
reconcilePage();
}
else{
displayContentFailed('bodyContent',formMgr.getErrorsArray());
}
});
formMgr.startBatch(true);
formMgr.queueCall(hpem.getSshKeys);
formMgr.queueCall(hpem.getSshFingerprint);
formMgr.endBatch();
}
function downloadSshKeys(){
var url=document.getElementById('urlToKeys').value;
if(url==''){
alert(top.getString('mustEnterUrl'));
return;
}
var formMgr=new FormManager(function(success){
if(success){
transformPage();
}
},false,'errorDisplay','bodyContent','waitContainer');
formMgr.createWaitContainer(top.getString('completingSSHKeyDownload'));
formMgr.startBatch();
formMgr.queueCall(hpem.downloadSshKeysFile,[url]);
formMgr.endBatch();
}
function clearSshKeys(){
var confirmString=top.getString('confirmClearSSHKeys');
if(confirm(confirmString)){
var formMgr=new FormManager(function(success){
if(success){
transformPage();
}
},false,'errorDisplay','bodyContent','waitContainer');
formMgr.createWaitContainer(top.getString('clearingSSHKeys'));
formMgr.startBatch();
formMgr.queueCall(hpem.clearSshKeys);
formMgr.endBatch();
}
}
function saveSshKeys(){
var keyString=document.getElementById('sshKeys').value;
var formMgr=new FormManager(function(success){
if(success){
transformPage();
}
},false,'keyErrorDisplay','bodyContent','waitContainer');
formMgr.createWaitContainer(top.getString('completingSSHKeyConfig'));
formMgr.startBatch();
formMgr.queueCall(hpem.setSshKeys,[keyString]);
formMgr.endBatch();
}
	</script>
</head>
<body style="margin:10px;" onload="loadContent();">
	<div id="bodyContent"></div>
	<div id="waitContainer" class="waitContainer"></div>
</body>
</html>
