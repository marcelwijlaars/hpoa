<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>

<head>
<title>HP Insight Display</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../css/default.css" />
<link rel="stylesheet" type="text/css" href="../css/blue_theme.css" />
<link rel="stylesheet" type="text/css" href="../css/MxPortalEx.css" />
<link rel="stylesheet" type="text/css" href="../css/widgets.css" />
<style type="text/css"> 		
	 td.lcdScreen{background:#999999;padding:1px 1px 1px 1px;width:320px;height:240px;text-align:center;}
	.deviceFrame,deviceFrameLeft,deviceFrameTop,deviceFrameRight,deviceFrameBottom{background:#e7e7e7;}
	.deviceFrameLeft{border-left:1px solid #cccccc;width:20px;}
	.deviceFrameRight{border-right:1px solid #cccccc;width:20px;}	
	.deviceFrameTop{border-left:1px solid #cccccc;border-top:1px solid #cccccc;border-right:1px solid #cccccc;height:10px;}
	.deviceFrameBottom{border-left:1px solid #cccccc;border-right:1px solid #cccccc;border-bottom:1px solid #cccccc;height:10px;}
	.deviceButtonRow{background:#cccccc;}
	.OkButton{text-align:center;font-family:arial;font-size:14px;width:34px;height:31px;padding:3px;}
	* html #lblOkButton{margin-left:-2px;padding-left:0px;padding-top:8px;}
	* html #vertRefresh{margin-top:2px;}
</style>
<script type="text/javascript" src="../js/EnvironConstants.js"></script>
<script type="text/javascript" src="../js/buttonManager.js"></script>
<script type="text/javascript" src="../js/tabManager.js"></script>
<script type="text/javascript" src="../js/global.js"></script>
<script type="text/javascript" src="../js/displayManager.js"></script>
<script type="text/javascript" src="../js/formManager.js"></script>
<script type="text/javascript" src="remoteLcdManager.js"></script>
 <!--
	Include the init and xml javascript files from the jsolait library.
	The xslt.js file requires that these two files be included before it.
-->
<script type="text/javascript" src="../js/init.js"></script>
<script type="text/javascript" src="../js/xml.js"></script>
<script type="text/javascript" src="../js/xslt.js"></script>
<script type="text/javascript">
var ourDisplayManager=null;
var ourRemoteLcdManager=null;
var encNum;
var emNum;
var hpem=null;
var chatMode=false;
var statusTrayCollapsed=top.mainPage.getStatusContainer().isStatusCollapsed();
var toggledStatusTray=false;
function myOnLoad(){
loadTitle();
ourDisplayManager=new DisplayManager('bodyContent','waitContainer');
loadContent("wait")
ourRemoteLcdManager=new RemoteLcdManager(hpem,emNum,doneLoading);
ourRemoteLcdManager.init();
top.mainPage.getHelpLauncher().setCurrentTopic("FORM_REMOTE_LCD");
}
function myOnUnload(){
try{
ourRemoteLcdManager.unload();
if(toggledStatusTray==true&top.mainPage.getStatusContainer().isStatusCollapsed()){
top.mainPage.getStatusContainer().toggleStatus(null);
}
}catch(err){}
}
function doneLoading(result){
loadContent("main");
ourRemoteLcdManager.setCallback(null);
ourRemoteLcdManager.setScreenImage(document.getElementById("imgLcd"),document.getElementById("txtNode"));
ourRemoteLcdManager.setImageContainer(document.getElementById("lcdContainer"));
ourRemoteLcdManager.getChatSession().setChatLogUpdateMethod(updateChatLog);
ourDisplayManager.showMainScreen();
globalComponentInit();
ourTabManager.toggleTabs("tabSecurity");
setTabContent("tabSecurity");
}
function loadContent(type){
var processor;
try{
encNum=parseInt(getSearchValue(location.search,'encNum'));
emNum=parseInt(getSearchValue(location.search,'emNum'));
if(!isNaN(encNum)&&
(hpem=top.mainPage.getHiddenFrame().getProxy(encNum))!=null){
switch(type){
case "main":
processor=new XsltProcessor('lcd-display.xsl');
processor.addParameter('stringsDoc',top.getStringsDoc());
processor.addParameter('lcdInfoDoc',getLcdMgr().getScreenInfo());
processor.addParameter('accessLevel',hpem.getUserAccessLevel());
processor.addParameter('oaAccess',hpem.getUserOaPermission());
document.getElementById('bodyContent').innerHTML=processor.getOutput();
break;
case "wait":
ourDisplayManager.createWaitContainer(top.getString('loadingLcdInfo'));
ourDisplayManager.showWaitScreen();
break;
}
}else{displayContentFailed('bodyContent',[top.getString('noOnboardAdmin')]);}
}catch(e){displayContentFailed('bodyContent',[e.message]);}
}
function getCurrentTab(){
return ourTabManager.getCurrentTab();
}
function setTabContent(tabid){
var theFrame=document.getElementById("lcdTabContent");
switch(tabid){
case "tabSecurity":
checkWindowSize(495);
window.setTimeout(function(){theFrame.src="lcd-security.html?encNum="+encNum;},10);
top.mainPage.getHelpLauncher().setCurrentTopic("FORM_REMOTE_LCD_SECURITY");
break;
case "tabUserNote":
checkWindowSize(495);
theFrame.src="lcd-usernotes.html?encNum="+encNum;
top.mainPage.getHelpLauncher().setCurrentTopic("FORM_REMOTE_LCD_USER_NOTE");
break;
case "tabBackground":
checkWindowSize(495);
theFrame.src="lcd-background.html?encNum="+encNum;
top.mainPage.getHelpLauncher().setCurrentTopic("FORM_REMOTE_LCD_IMAGE");
break;
case "tabChatMode":
checkWindowSize(590);
theFrame.src="lcd-chat.html?encNum="+encNum;
top.mainPage.getHelpLauncher().setCurrentTopic("FORM_REMOTE_LCD_CHAT");
break;
}
}
function adjustFrameHeight(theFrame){
var theBody=theFrame.contentWindow.document.documentElement;
var theBodyDiv=theFrame.contentWindow.document.getElementById('bodyContent');
try{
theFrame.style.height=(theBodyDiv.offsetHeight+20)+'px';
theBody.scrollTop=0;
}catch(e){}
};
function checkWindowSize(minWidth){
if(statusTrayCollapsed==true){
return;
}
var winWidth=0;
if(window.innerWidth){
winWidth=window.innerWidth;
}else if(window.frameElement.width){
winWidth=window.frameElement.width;
minWidth+=6;
}else{
return;
}
if(top.mainPage.getStatusContainer().isStatusExpanded()){
if(winWidth<minWidth){
top.mainPage.getStatusContainer().toggleStatus(null);
toggledStatusTray=true;
}
}else{
if((winWidth-230)>minWidth){
top.mainPage.getStatusContainer().toggleStatus(null);
toggledStatusTray=false;
}
}
}
function updateChatLog(msg){
var chatWindow=document.getElementById("txtChatLog");
chatWindow.value=chatWindow.value+
(chatWindow.value==""?"":"\n")+msg+"\n";
scrollToEnd(chatWindow);
}
function scrollToEnd(obj){
for(var i=0;i<5;i++){
obj.scrollTop=obj.scrollHeight;
}
}
function toggleChatMode(toggleOn){
var chatWindow=document.getElementById("txtChatLog");
var chatCell=document.getElementById("cellChatLog");
chatMode=toggleOn;
loadTitle();
if(chatMode){
chatWindow.style.visibility='visible';
chatWindow.cols=30;
chatCell.style.width="60%";
scrollToEnd(chatWindow);
}else{
chatWindow.style.visibility='hidden';
chatCell.style.width="1%";
chatWindow.cols=1;
}
}
function loadTitle(){
var title=top.getString('lcdScreen');
if(null!=top.mainPage){
top.mainPage.setMainTitle(title);
}
}
function isChatMode(){
return chatMode;
}
function getLcdMgr(){
try{
return ourRemoteLcdManager;
}catch(e){}
}
function buttonEvent(button,state){
switch(button){
case LCD_UP():
case LCD_LEFT():
case LCD_DOWN():
case LCD_RIGHT():
case LCD_OK():
ourRemoteLcdManager.pressButton(button,state);
break;
case "LCD_REFRESH":
ourRemoteLcdManager.reset(null,true);
}
}
</script>
</head>

<body style="margin:10px;" onload="myOnLoad();" onunload="myOnUnload();">
<div id="bodyContent"></div>
<span id="waitContainer" class="waitContainer" style="padding:80px 40px 0px 40px;"></span>
</body>
</html>
