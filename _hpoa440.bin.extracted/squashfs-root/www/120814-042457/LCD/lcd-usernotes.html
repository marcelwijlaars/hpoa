<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>
<head>
<title>HP Insight Display User Note</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../css/default.css" />
<link rel="stylesheet" type="text/css" href="../css/blue_theme.css" />
<link rel="stylesheet" type="text/css" href="../css/MxPortalEx.css" />
<style type="text/css">
	td.stdLabelCell{padding-bottom:3px;}
	td.stdCheckCell{vertical-align:top;}
</style>
<script type="text/javascript" src="../js/EnvironConstants.js"></script>
<script type="text/javascript" src="../js/buttonManager.js"></script>
<script type="text/javascript" src="../js/inputValidator.js"></script>
<script type="text/javascript" src="../js/displayManager.js"></script>
<script type="text/javascript" src="../js/global.js"></script>

 <!--
	Include the init and xml javascript files from the jsolait library.
	The xslt.js file requires that these two files be included before it.
-->
<script type="text/javascript" src="../js/init.js"></script>
<script type="text/javascript" src="../js/xml.js"></script>
<script type="text/javascript" src="../js/xslt.js"></script>
<script type="text/javascript">
var MAX_LINES=6;
var ourInputValidator;
var ourDisplayManager;
var reset=false;
function getMgr(){
return window.parent.getLcdMgr();
}
function myOnLoad(){
loadContent();
globalComponentInit();
ourDisplayManager=new DisplayManager('bodyContent','waitContent');
ourInputValidator=new InputValidator();
ourInputValidator.init();
focusLineOne();
}
function loadContent(){
try{
encNum=parseInt(getSearchValue(location.search,'encNum'));
if(!isNaN(encNum)&&
(hpem=top.mainPage.getHiddenFrame().getProxy(encNum))!=null){
var processor=new XsltProcessor('lcd-usernotes.xsl');
processor.addParameter('stringsDoc',top.getStringsDoc());
processor.addParameter('userNoteDoc',getMgr().getUserNoteInfo());
processor.addParameter('accessLevel',hpem.getUserAccessLevel());
processor.addParameter('oaAccess',hpem.getUserOaPermission());
document.getElementById('bodyContent').innerHTML=processor.getOutput();
processor=new XsltProcessor('../Templates/waitContainer.xsl');
processor.addParameter('waitText',top.getString('completingLcdUserNoteSettings'));
document.getElementById("waitContent").innerHTML=processor.getOutput();
}else{
displayContentFailed('bodyContent',[top.getString('noOnboardAdmin')]);}
}catch(e){displayContentFailed('bodyContent',[e.message]);}
}
function focusLineOne(){
try{
document.getElementById("txtLine1").focus();
}catch(e){}
}
function previewUsernotes(){
getMgr().pressButton('LCD_USERNOTES','CLICKED');
}
function setLcdUserNotesResponse(success){
ourDisplayManager.showMainScreen();
if(!success){
alert(getMgr().callManager.getErrorList(),AlertMsgTypes.Warning,60);
}
if(reset||!success){
myOnLoad();
}
}
function updateLcdText(remove){
var userNotes=new Array(MAX_LINES);
if(remove){
if(confirm(top.getString("confirmlcdRemoveUserNote"))){
ourDisplayManager.showWaitScreen();
reset=true;
getMgr().setCallback(setLcdUserNotesResponse);
getMgr().getUserNotes().removeUserNotes();
}
}else if(ourInputValidator.allInputsValidate()){
for(var i=0;i<userNotes.length;i++){
userNotes[i]=document.getElementById("txtLine"+(i+1)).value;
}
ourDisplayManager.showWaitScreen();
reset=false;
getMgr().setCallback(setLcdUserNotesResponse);
getMgr().getUserNotes().setUserNotes(userNotes);
}else{
alert(ourInputValidator.getFirstRuleBroken(),AlertMsgTypes.Warning,60);
ourInputValidator.autoFocus();
}
}
function setTabContent(tabId){
window.parent.setTabContent(tabId);
}
function getCurrentTab(){
return 'tabUserNote';
}
</script>
</head>
<body style="margin:10px;" onload="myOnLoad();">
<div id="bodyContent"></div>
<span id="waitContent" class="waitContainer"></span>
</body>
</html>
