<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>
<head>
<title>HP Insight Display Background Image</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../css/default.css" />
<link rel="stylesheet" type="text/css" href="../css/blue_theme.css" />
<link rel="stylesheet" type="text/css" href="../css/MxPortalEx.css" />
<script type="text/javascript" src="../js/EnvironConstants.js"></script>
<script type="text/javascript" src="../js/buttonManager.js"></script>
<script type="text/javascript" src="../js/postBackManager.js"></script>
<script type="text/javascript" src="../js/inputValidator.js"></script>
<script type="text/javascript" src="../js/displayManager.js"></script>
<script type="text/javascript" src="../js/global.js"></script>

 <!--
	Include the init and xml javascript files from the jsolait library.
	The xslt.js file requires that these two files be included before it.
-->
<script type="text/javascript" src="../js/init.js"></script>
<script type="text/javascript" src="../js/xml.js"></script>
<script type="text/javascript" src="../js/xslt.js"></script>
<script type="text/javascript">
var ourDisplayManager;
var outInputValidator;
var hpem;
var encNum;
function getMgr(){
return window.parent.getLcdMgr();
}
function myOnLoad(){
loadContent();
globalComponentInit();
focusFileInput();
ourDisplayManager=new DisplayManager('bodyContent','waitContent');
ourInputValidator=new InputValidator();
ourInputValidator.init();
}
function loadContent(){
try{
encNum=parseInt(getSearchValue(location.search,'encNum'));
if(!isNaN(encNum)&&
(hpem=top.mainPage.getHiddenFrame().getProxy(encNum))!=null){
var processor=new XsltProcessor('lcd-background.xsl');
processor.addParameter('stringsDoc',top.getStringsDoc());
processor.addParameter('oaUrl',getMgr().oaUrl);
processor.addParameter('oaSessionKey',hpem.getSessionKey());
processor.addParameter('fileType','LCD_IMAGE');
processor.addParameter('stylesheet','/120814-042457/Forms/UploadFileResponse.xsl');
processor.addParameter('accessLevel',hpem.getUserAccessLevel());
processor.addParameter('oaAccess',hpem.getUserOaPermission());
document.getElementById('bodyContent').innerHTML=ipv6UrlFix(processor.getOutput());
processor=new XsltProcessor('../Templates/waitContainer.xsl');
processor.addParameter('waitText',top.getString('completingLcdImageSettings'));
document.getElementById("waitContent").innerHTML=processor.getOutput();
}else{
displayContentFailed('bodyContent',[top.getString('noOnboardAdmin')]);}
}catch(e){displayContentFailed('bodyContent',[e.message]);}
}
function submitMe(uploading){
if(uploading){
if(ourInputValidator.allInputsValidate()){
ourDisplayManager.showWaitScreen();
try{
document.getElementById("frmUpload").submit();
}catch(e){
var errMsg=e.message;
if(e.number==-2147024891){
errMsg=top.getString('invalidFilename');
}
alert(errMsg,AlertMsgTypes.Warning,60);
ourDisplayManager.showMainScreen();
focusFileInput();
}
}else{
alert(ourInputValidator.getFirstRuleBroken(),AlertMsgTypes.Warning,60);
ourInputValidator.autoFocus();
}
}else{
if(confirm(top.getString('confirmRemoveLcdImage'))){
ourDisplayManager.showWaitScreen();
getMgr().setCallback(LcdImageResponse);
getMgr().getUserNotes().removeUserImage();
}
}
return false;
}
function previewUsernotes(){
getMgr().pressButton('LCD_USERNOTES','CLICKED');
return false;
}
function LcdImageResponse(result,err){
ourDisplayManager.showMainScreen();
}
function postBack(targetDocument){
var postBackMgr=new PostBackManager(targetDocument,"frmUpload","oaFileToken");
if(postBackMgr.getIsPostBack()){
LcdImageResponse();
if(!postBackMgr.getSuccess()){
alert(postBackMgr.getErrorString(),AlertMsgTypes.Warning,60);
focusFileInput();
}
}
}
function focusFileInput(){
var f=document.getElementById("file");
try{
f.focus();
f.select();
}catch(e){}
}
function setTabContent(tabId){
window.parent.setTabContent(tabId);
}
function getCurrentTab(){
return 'tabBackground';
}
</script>
</head>
<body style="margin:10px;" onload="myOnLoad();">
  <div id="bodyContent"></div>
  <span id="waitContent" class="waitContainer"></span>
  <!-- hidden iframe for post target. -->
	<iframe src="blank.html" onload="try{postBack(this.contentWindow.document);}catch(e){}" scrolling="auto" name="iframeHidden" id="iframeHidden" width="0" height="0" frameborder="0"></iframe>
</body>
</html>